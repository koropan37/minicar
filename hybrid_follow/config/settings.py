"""
ハイブリッド走行（適応型壁追従）の設定ファイル
コース状況に応じて左壁、右壁、中央維持を切り替える

【完走優先版】
- 速度を落として確実に完走することを最優先
- 壁検知を早めに行い、余裕を持って回避
"""

# ===========================================
# センサー設定 (VL53L4CD)
# ===========================================
# センサー配置: [真左, 斜め左前, 正面, 斜め右前, 真右]
# インデックス:    0       1       2       3        4
XSHUT_PINS = [17, 27, 22, 23, 24]

# センサーI2Cアドレスのベース
SENSOR_BASE_ADDRESS = 0x30

# センサータイミング設定
SENSOR_TIMING_BUDGET = 50
SENSOR_INTER_MEASUREMENT = 60

# センサー無効値 (mm)
SENSOR_INVALID_VALUE = 9999
SENSOR_MAX_RANGE = 1300  # VL53L4CDの最大測定距離 (mm)

# ===========================================
# サーボ設定 (ステアリング)
# ===========================================
SERVO_CHANNEL = 0
SERVO_MIN_PULSE = 500
SERVO_MAX_PULSE = 2500

# ステアリング角度（実測値）
SERVO_CENTER = 114  # 真っ直ぐ
SERVO_LEFT = 92     # 左いっぱい
SERVO_RIGHT = 140   # 右いっぱい

# ===========================================
# ESC設定 (モーター)
# ===========================================
ESC_CHANNEL = 1
ESC_MIN_PULSE = 1100
ESC_MAX_PULSE = 2000

# スロットル値（実測値: -1.0 ~ 1.0）
THROTTLE_STOP = 0.0
THROTTLE_SLOW = 0.20      # 低速旋回用（0.26→0.20に減速）
THROTTLE_NORMAL = 0.26    # 通常走行（0.35→0.26に減速）
THROTTLE_FAST = 0.32      # 高速（0.40→0.32に減速）
THROTTLE_REVERSE = -0.16  

# ===========================================
# PCA9685設定
# ===========================================
PCA9685_FREQUENCY = 50

# ===========================================
# ハイブリッド制御パラメータ
# ===========================================

# 壁検出閾値 (mm)
WALL_TOO_CLOSE = 280      # 緊急回避レベル（150→280に拡大：早めにバック）
WALL_VALID_MAX = 800      # これ以上遠いと壁として信頼しない
FRONT_OBSTACLE_DIST = 750 # 前方の障害物検知距離（500→750に拡大：早めに回避）

# 目標距離
TARGET_WALL_DIST = 450    # 壁からの目標距離（400→450に拡大：余裕を持つ）

# PIDゲイン（簡易P制御）
STEERING_P_GAIN = 0.28    # 壁追従用（0.15→0.28に強化：カーブで強く曲がる）
CENTER_P_GAIN = 0.18      # 中央維持用（0.10→0.18に強化）

# ===========================================
# 制御周期設定
# ===========================================
CONTROL_INTERVAL = 0.04  # 40ms (25Hz)

# ===========================================
# デバッグ設定
# ===========================================
DEBUG_PRINT_INTERVAL = 1  
ENABLE_DEBUG_LOG = True
